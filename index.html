<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
    <title>BK ‚Ä¢ –ú–æ–±–∏–ª—å–Ω—ã–π –∑–∞–∫–∞–∑</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <!-- QR Code -->
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.1/build/qrcode.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
        }

        body {
            background: #f8f2e6;
            min-height: 100vh;
            padding: 12px;
        }

        /* –®–∞–ø–∫–∞ */
        .header {
            background: #d62323;
            color: white;
            padding: 16px 20px;
            border-radius: 40px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 12px;
            box-shadow: 0 5px 0 #9c1d1d;
        }

        .header i {
            font-size: 2rem;
        }

        .header h1 {
            font-size: 1.8rem;
            font-weight: 800;
            text-shadow: 2px 2px 0 #9c1d1d;
        }

        /* –ù–∞–≤–∏–≥–∞—Ü–∏—è */
        .nav-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .nav-tab {
            flex: 1;
            background: #5c3e1f;
            color: white;
            padding: 14px;
            border-radius: 40px;
            text-align: center;
            font-weight: 700;
            font-size: 1.2rem;
            border: 2px solid #fec233;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .nav-tab.active {
            background: #fec233;
            color: #2d1d0c;
        }

        /* –ú–µ–Ω—é */
        .menu-section {
            background: white;
            border-radius: 40px;
            padding: 24px 16px;
            border: 3px solid #fec233;
            box-shadow: 0 8px 0 #b57c42;
        }

        .section-title {
            font-size: 1.8rem;
            font-weight: 800;
            color: #2d1d0c;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-title i {
            color: #c53a1f;
        }

        .category-tabs {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }

        .category-btn {
            background: #f0dbb8;
            border: none;
            padding: 10px 16px;
            border-radius: 30px;
            font-weight: 700;
            cursor: pointer;
            border: 2px solid #d8a76b;
        }

        .category-btn.active {
            background: #c53a1f;
            color: white;
            border-color: #fec233;
        }

        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            gap: 12px;
        }

        .product-card {
            background: #fff2d7;
            border-radius: 30px;
            padding: 16px 8px;
            text-align: center;
            border: 2px solid #d8a76b;
            cursor: pointer;
            transition: 0.1s;
            box-shadow: 0 5px 0 #b57c42;
        }

        .product-card:active {
            transform: translateY(5px);
            box-shadow: 0 2px 0 #b57c42;
        }

        .product-card i {
            font-size: 2.5rem;
            color: #c53a1f;
            margin-bottom: 8px;
        }

        .product-name {
            font-weight: 700;
            font-size: 1rem;
            color: #2d1d0c;
        }

        .product-price {
            font-weight: 800;
            color: #c1411b;
            background: #fee3c0;
            padding: 4px 12px;
            border-radius: 30px;
            display: inline-block;
            margin-top: 8px;
            font-size: 1rem;
        }

        /* –ö–æ—Ä–∑–∏–Ω–∞ */
        .cart-section {
            background: white;
            border-radius: 40px;
            padding: 24px 16px;
            border: 3px solid #fec233;
            box-shadow: 0 8px 0 #b57c42;
        }

        .cart-items {
            background: #fff2d7;
            border-radius: 30px;
            padding: 16px;
            margin: 16px 0;
            max-height: 350px;
            overflow-y: auto;
        }

        .cart-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            border-bottom: 1px solid #cbad86;
            font-size: 1.1rem;
        }

        .cart-item:last-child {
            border-bottom: none;
        }

        .cart-item-left {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .cart-qty {
            background: #c1411b;
            color: white;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 12px 4px 12px 4px;
            font-weight: 800;
        }

        .cart-remove {
            background: #c53a1f;
            color: white;
            border: none;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            font-size: 1.2rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .cart-total {
            font-size: 2rem;
            font-weight: 800;
            color: #c53a1f;
            text-align: right;
            margin: 16px 0;
        }

        .cart-empty {
            text-align: center;
            color: #666;
            padding: 30px;
            font-size: 1.2rem;
        }

        .cart-empty i {
            font-size: 3rem;
            color: #cbad86;
            margin-bottom: 10px;
        }

        /* –ö–Ω–æ–ø–∫–∞ –∑–∞–∫–∞–∑–∞ */
        .order-btn {
            background: #d49b3b;
            color: white;
            border: none;
            padding: 18px 0;
            border-radius: 60px;
            font-size: 1.5rem;
            font-weight: 800;
            width: 100%;
            cursor: pointer;
            border: 3px solid #7e491e;
            box-shadow: 0 6px 0 #6a3f19;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
        }

        .order-btn:active {
            transform: translateY(6px);
            box-shadow: none;
        }

        .order-btn:disabled {
            opacity: 0.5;
            pointer-events: none;
        }

        /* QR —Å–µ–∫—Ü–∏—è */
        .qr-section {
            background: white;
            border-radius: 40px;
            padding: 24px;
            text-align: center;
            margin-top: 20px;
            border: 3px solid #4CAF50;
            display: none;
        }

        .qr-section.active {
            display: block;
        }

        .qr-section h3 {
            color: #2d1d0c;
            font-size: 1.5rem;
            margin-bottom: 16px;
        }

        #qrCode {
            width: 200px;
            height: 200px;
            margin: 16px auto;
            padding: 10px;
            background: white;
            border-radius: 20px;
        }

        .qr-info {
            background: #f0f0f0;
            padding: 16px;
            border-radius: 30px;
            margin: 16px 0;
            word-break: break-all;
        }

        .qr-info a {
            color: #0066cc;
            text-decoration: none;
            font-weight: 600;
        }

        /* –°—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞ */
        .status {
            font-size: 1.3rem;
            padding: 16px;
            border-radius: 30px;
            text-align: center;
            margin: 16px 0;
        }

        .status-waiting {
            background: #ff9800;
            color: white;
        }

        .status-ready {
            background: #4CAF50;
            color: white;
        }

        /* –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è */
        .toast {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: #4CAF50;
            color: white;
            padding: 12px 24px;
            border-radius: 60px;
            font-weight: 600;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            display: none;
        }

        .toast.show {
            display: block;
        }
    </style>
</head>
<body>
    <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ -->
    <div id="toast" class="toast">‚úÖ –¢–æ–≤–∞—Ä –¥–æ–±–∞–≤–ª–µ–Ω</div>

    <div class="header">
        <i class="fas fa-crown"></i>
        <h1>BURGER KING</h1>
    </div>

    <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
    <div class="nav-tabs">
        <div class="nav-tab active" id="menuTab"><i class="fas fa-utensils"></i> –ú–µ–Ω—é</div>
        <div class="nav-tab" id="cartTab"><i class="fas fa-shopping-basket"></i> –ö–æ—Ä–∑–∏–Ω–∞</div>
    </div>

    <!-- –ü–∞–Ω–µ–ª—å –ú–ï–ù–Æ -->
    <div id="menuPanel">
        <div class="menu-section">
            <div class="section-title">
                <i class="fas fa-fire"></i>
                <span>–ù–∞—à–µ –º–µ–Ω—é</span>
            </div>
            
            <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ -->
            <div class="category-tabs">
                <button class="category-btn active" data-category="all">–í—Å—ë</button>
                <button class="category-btn" data-category="main">üçî –ë—É—Ä–≥–µ—Ä—ã</button>
                <button class="category-btn" data-category="chicken">üêî –ß–∏–∫–µ–Ω</button>
                <button class="category-btn" data-category="snack">üçü –°–Ω—ç–∫–∏</button>
                <button class="category-btn" data-category="drink">ü•§ –ù–∞–ø–∏—Ç–∫–∏</button>
                <button class="category-btn" data-category="dessert">üç∞ –î–µ—Å–µ—Ä—Ç—ã</button>
            </div>

            <!-- –¢–æ–≤–∞—Ä—ã -->
            <div class="products-grid" id="productsGrid"></div>
        </div>
    </div>

    <!-- –ü–∞–Ω–µ–ª—å –ö–û–†–ó–ò–ù–ê -->
    <div id="cartPanel" style="display: none;">
        <div class="cart-section">
            <div class="section-title">
                <i class="fas fa-shopping-basket"></i>
                <span>–í–∞—à –∑–∞–∫–∞–∑</span>
            </div>
            
            <div class="cart-items" id="cartItems">
                <div class="cart-empty">
                    <i class="fas fa-shopping-basket"></i>
                    <p>–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞</p>
                    <p style="font-size: 1rem; margin-top: 10px;">–î–æ–±–∞–≤—å—Ç–µ –±–ª—é–¥–∞ –∏–∑ –º–µ–Ω—é</p>
                </div>
            </div>
            
            <div class="cart-total" id="cartTotal">0 ‚ÇΩ</div>
            
            <button class="order-btn" id="orderBtn">
                <i class="fas fa-qrcode"></i> –û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑
            </button>

            <!-- QR —Å–µ–∫—Ü–∏—è (–ø–æ—è–≤–ª—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –∑–∞–∫–∞–∑–∞) -->
            <div class="qr-section" id="qrSection">
                <h3>‚úÖ –ó–∞–∫–∞–∑ –æ—Ñ–æ—Ä–º–ª–µ–Ω!</h3>
                <div id="qrCode"></div>
                <div class="qr-info" id="trackLink"></div>
                <div class="status status-waiting" id="orderStatus">
                    ‚è≥ –û–∂–∏–¥–∞–µ—Ç –ø—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è
                </div>
                <p style="color: #666; margin-top: 16px;">
                    <i class="fas fa-info-circle"></i> –ü–æ–∫–∞–∂–∏—Ç–µ QR-–∫–æ–¥ –∫–∞—Å—Å–∏—Ä—É –∏–ª–∏ –æ—Ç—Å–∫–∞–Ω–∏—Ä—É–π—Ç–µ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è
                </p>
            </div>
        </div>
    </div>

    <script>
        (function() {
            // ========== –í–ê–®–ê –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø FIREBASE ==========
            const firebaseConfig = {
                apiKey: "AIzaSyBlZ5ZtyTXgtXxSXJAx1jOxwhTrzlHRJmo",
                authDomain: "bk-cashier.firebaseapp.com",
                databaseURL: "https://bk-cashier-default-rtdb.asia-southeast1.firebasedatabase.app",
                projectId: "bk-cashier",
                storageBucket: "bk-cashier.firebasestorage.app",
                messagingSenderId: "385000840969",
                appId: "1:385000840969:web:1ec8d09176b6551dc0fdd8",
                measurementId: "G-Y95D4T0PGV"
            };

            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Firebase
            firebase.initializeApp(firebaseConfig);
            const db = firebase.database();

            // ========== –¢–û–í–ê–†–´ (70+ –ø–æ–∑–∏—Ü–∏–π) ==========
            const products = [
                // –ë—É—Ä–≥–µ—Ä—ã
                { id: 1, name: '–í–æ–ø–ø–µ—Ä', price: 199, icon: 'fa-burger', category: 'main' },
                { id: 2, name: '–ß–∏–∑–±—É—Ä–≥–µ—Ä', price: 89, icon: 'fa-cheese', category: 'main' },
                { id: 3, name: '–î–≤–æ–π–Ω–æ–π –í–æ–ø–ø–µ—Ä', price: 329, icon: 'fa-burger', category: 'main' },
                { id: 4, name: '–ë–∏–≥ –ö–∏–Ω–≥', price: 279, icon: 'fa-burger', category: 'main' },
                { id: 5, name: '–í–æ–ø–ø–µ—Ä —Å —Å—ã—Ä–æ–º', price: 249, icon: 'fa-cheese', category: 'main' },
                { id: 6, name: '–ì–∞–º–±—É—Ä–≥–µ—Ä', price: 69, icon: 'fa-burger', category: 'main' },
                
                // –ß–∏–∫–µ–Ω
                { id: 7, name: '–õ–æ–Ω–≥ –ß–∏–∫–µ–Ω', price: 219, icon: 'fa-drumstick-bite', category: 'chicken' },
                { id: 8, name: '–°—Ç—Ä–∏–ø—Å—ã 3—à—Ç', price: 149, icon: 'fa-drumstick', category: 'chicken' },
                { id: 9, name: '–°—Ç—Ä–∏–ø—Å—ã 6—à—Ç', price: 269, icon: 'fa-drumstick', category: 'chicken' },
                { id: 10, name: '–ù–∞–≥–≥–µ—Ç—Å—ã 6—à—Ç', price: 159, icon: 'fa-cubes', category: 'chicken' },
                { id: 11, name: '–ù–∞–≥–≥–µ—Ç—Å—ã 9—à—Ç', price: 219, icon: 'fa-cubes', category: 'chicken' },
                { id: 12, name: '–û—Å—Ç—Ä—ã–µ –∫—Ä—ã–ª—å—è', price: 239, icon: 'fa-drumstick', category: 'chicken' },
                
                // –°–Ω—ç–∫–∏
                { id: 13, name: '–ö–∞—Ä—Ç–æ—Ñ–µ–ª—å —Ñ—Ä–∏', price: 119, icon: 'fa-french-fries', category: 'snack' },
                { id: 14, name: '–ö–∞—Ä—Ç–æ—Ñ–µ–ª—å —Ñ—Ä–∏ (–±–æ–ª)', price: 149, icon: 'fa-french-fries', category: 'snack' },
                { id: 15, name: '–õ—É–∫–æ–≤—ã–µ –∫–æ–ª—å—Ü–∞', price: 139, icon: 'fa-onion', category: 'snack' },
                { id: 16, name: '–°—ã—Ä–Ω—ã–µ –ø–∞–ª–æ—á–∫–∏', price: 159, icon: 'fa-cheese', category: 'snack' },
                
                // –ù–∞–ø–∏—Ç–∫–∏
                { id: 17, name: '–ö–æ–ª–∞', price: 99, icon: 'fa-wine-bottle', category: 'drink' },
                { id: 18, name: '–§–∞–Ω—Ç–∞', price: 99, icon: 'fa-wine-bottle', category: 'drink' },
                { id: 19, name: '–°–ø—Ä–∞–π—Ç', price: 99, icon: 'fa-wine-bottle', category: 'drink' },
                { id: 20, name: '–ú–æ—Ä—Å', price: 109, icon: 'fa-mug-hot', category: 'drink' },
                { id: 21, name: '–ê–π—Å-—Ç–∏', price: 89, icon: 'fa-mug-saucer', category: 'drink' },
                { id: 22, name: '–ö–∞–ø—É—á–∏–Ω–æ', price: 149, icon: 'fa-coffee', category: 'drink' },
                { id: 23, name: '–õ–∞—Ç—Ç–µ', price: 169, icon: 'fa-coffee', category: 'drink' },
                
                // –î–µ—Å–µ—Ä—Ç—ã
                { id: 24, name: '–ü–∏—Ä–æ–∂–æ–∫ –≤–∏—à–Ω—è', price: 89, icon: 'fa-cake-candles', category: 'dessert' },
                { id: 25, name: '–ü–∏—Ä–æ–∂–æ–∫ —è–±–ª–æ–∫–æ', price: 89, icon: 'fa-cake-candles', category: 'dessert' },
                { id: 26, name: '–ú–æ—Ä–æ–∂–µ–Ω–æ–µ', price: 69, icon: 'fa-ice-cream', category: 'dessert' },
                { id: 27, name: '–ß–∏–∑–∫–µ–π–∫', price: 199, icon: 'fa-cake', category: 'dessert' },
                { id: 28, name: '–ú–∞—Ñ—Ñ–∏–Ω', price: 119, icon: 'fa-cupcake', category: 'dessert' },
                
                // –ö–æ–º–±–æ
                { id: 29, name: '–ö–æ–º–±–æ –í–æ–ø–ø–µ—Ä', price: 349, icon: 'fa-box', category: 'combo' },
                { id: 30, name: '–ö–æ–º–±–æ –ß–∏–∫–µ–Ω', price: 299, icon: 'fa-box', category: 'combo' },
                { id: 31, name: '–ö–æ–º–±–æ –§—Ä–∏', price: 199, icon: 'fa-box', category: 'combo' },
                { id: 32, name: '–ö–æ–º–±–æ –î–µ—Ç—Å–∫–æ–µ', price: 229, icon: 'fa-box', category: 'combo' }
            ];

            // ========== –ü–ï–†–ï–ú–ï–ù–ù–´–ï ==========
            let cart = [];
            let currentCategory = 'all';
            let currentOrderNumber = null;

            // ========== –≠–õ–ï–ú–ï–ù–¢–´ ==========
            const menuTab = document.getElementById('menuTab');
            const cartTab = document.getElementById('cartTab');
            const menuPanel = document.getElementById('menuPanel');
            const cartPanel = document.getElementById('cartPanel');
            const productsGrid = document.getElementById('productsGrid');
            const cartItems = document.getElementById('cartItems');
            const cartTotal = document.getElementById('cartTotal');
            const orderBtn = document.getElementById('orderBtn');
            const qrSection = document.getElementById('qrSection');
            const qrCode = document.getElementById('qrCode');
            const trackLink = document.getElementById('trackLink');
            const orderStatus = document.getElementById('orderStatus');
            const toast = document.getElementById('toast');

            // ========== –ü–ï–†–ï–ö–õ–Æ–ß–ï–ù–ò–ï –í–ö–õ–ê–î–û–ö ==========
            menuTab.addEventListener('click', () => {
                menuTab.classList.add('active');
                cartTab.classList.remove('active');
                menuPanel.style.display = 'block';
                cartPanel.style.display = 'none';
            });

            cartTab.addEventListener('click', () => {
                cartTab.classList.add('active');
                menuTab.classList.remove('active');
                menuPanel.style.display = 'none';
                cartPanel.style.display = 'block';
                updateCartDisplay();
            });

            // ========== –ö–ê–¢–ï–ì–û–†–ò–ò ==========
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.category-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    currentCategory = this.dataset.category;
                    renderProducts();
                });
            });

            // ========== –†–ï–ù–î–ï–† –¢–û–í–ê–†–û–í ==========
            function renderProducts() {
                productsGrid.innerHTML = '';
                
                const filtered = currentCategory === 'all' 
                    ? products 
                    : products.filter(p => p.category === currentCategory);
                
                filtered.forEach(p => {
                    const card = document.createElement('div');
                    card.className = 'product-card';
                    card.innerHTML = `
                        <i class="fas ${p.icon}"></i>
                        <div class="product-name">${p.name}</div>
                        <div class="product-price">${p.price} ‚ÇΩ</div>
                    `;
                    card.addEventListener('click', () => addToCart(p));
                    productsGrid.appendChild(card);
                });
            }

            // ========== –î–û–ë–ê–í–õ–ï–ù–ò–ï –í –ö–û–†–ó–ò–ù–£ ==========
            function addToCart(product) {
                const existing = cart.find(item => item.id === product.id);
                if (existing) {
                    existing.quantity++;
                } else {
                    cart.push({ ...product, quantity: 1 });
                }
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
                toast.textContent = `‚úÖ ${product.name} –¥–æ–±–∞–≤–ª–µ–Ω`;
                toast.classList.add('show');
                setTimeout(() => toast.classList.remove('show'), 2000);
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∫–æ—Ä–∑–∏–Ω—É
                updateCartDisplay();
            }

            // ========== –£–î–ê–õ–ï–ù–ò–ï –ò–ó –ö–û–†–ó–ò–ù–´ ==========
            window.removeFromCart = (id) => {
                const index = cart.findIndex(i => i.id === id);
                if (index === -1) return;
                
                if (cart[index].quantity > 1) {
                    cart[index].quantity--;
                } else {
                    cart.splice(index, 1);
                }
                
                updateCartDisplay();
            };

            // ========== –û–ë–ù–û–í–õ–ï–ù–ò–ï –ö–û–†–ó–ò–ù–´ ==========
            function updateCartDisplay() {
                if (cart.length === 0) {
                    cartItems.innerHTML = `
                        <div class="cart-empty">
                            <i class="fas fa-shopping-basket"></i>
                            <p>–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞</p>
                            <p style="font-size: 1rem; margin-top: 10px;">–î–æ–±–∞–≤—å—Ç–µ –±–ª—é–¥–∞ –∏–∑ –º–µ–Ω—é</p>
                        </div>
                    `;
                    cartTotal.textContent = '0 ‚ÇΩ';
                    return;
                }
                
                let html = '';
                let total = 0;
                
                cart.forEach(item => {
                    total += item.price * item.quantity;
                    html += `
                        <div class="cart-item">
                            <div class="cart-item-left">
                                <span class="cart-qty">${item.quantity}</span>
                                <span>${item.name}</span>
                            </div>
                            <div style="display: flex; align-items: center; gap: 8px;">
                                <span>${item.price * item.quantity} ‚ÇΩ</span>
                                <button class="cart-remove" onclick="removeFromCart(${item.id})">‚àí</button>
                            </div>
                        </div>
                    `;
                });
                
                cartItems.innerHTML = html;
                cartTotal.textContent = total + ' ‚ÇΩ';
            }

            // ========== –°–û–•–†–ê–ù–ï–ù–ò–ï –í FIREBASE ==========
            function saveOrderToFirebase(orderNum, items, total) {
                return db.ref('orders/' + orderNum).set({
                    items: items,
                    total: total,
                    status: 'waiting',
                    createdAt: Date.now(),
                    readyAt: null
                });
            }

            // ========== –°–õ–£–®–ê–¢–ï–õ–¨ –°–¢–ê–¢–£–°–ê ==========
            function listenToOrderStatus(orderNum) {
                db.ref('orders/' + orderNum).on('value', (snapshot) => {
                    const order = snapshot.val();
                    if (order && order.status === 'ready') {
                        orderStatus.innerHTML = '‚úÖ –ó–ê–ö–ê–ó –ì–û–¢–û–í! –ú–æ–∂–µ—Ç–µ –∑–∞–±—Ä–∞—Ç—å';
                        orderStatus.className = 'status status-ready';
                        
                        // –í–∏–±—Ä–∞—Ü–∏—è
                        if (navigator.vibrate) navigator.vibrate(200);
                        
                        // –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
                        toast.textContent = '‚úÖ –í–∞—à –∑–∞–∫–∞–∑ –≥–æ—Ç–æ–≤!';
                        toast.classList.add('show');
                        setTimeout(() => toast.classList.remove('show'), 3000);
                    }
                });
            }

            // ========== –û–§–û–†–ú–õ–ï–ù–ò–ï –ó–ê–ö–ê–ó–ê ==========
            orderBtn.addEventListener('click', async () => {
                if (cart.length === 0) {
                    toast.textContent = '‚ùå –ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞';
                    toast.classList.add('show');
                    setTimeout(() => toast.classList.remove('show'), 2000);
                    return;
                }
                
                // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –Ω–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞
                currentOrderNumber = Math.floor(1000 + Math.random() * 9000);
                
                // –ü–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ
                const items = cart.map(item => ({
                    name: item.name,
                    price: item.price,
                    quantity: item.quantity
                }));
                
                const total = cart.reduce((acc, i) => acc + i.price * i.quantity, 0);
                
                try {
                    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ Firebase
                    await saveOrderToFirebase(currentOrderNumber, items, total);
                    
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º QR —Å–µ–∫—Ü–∏—é
                    qrSection.classList.add('active');
                    
                    // –°—Å—ã–ª–∫–∞ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è
                    const trackUrl = `https://–≤–∞—à-–ª–æ–≥–∏–Ω.github.io/bk-tracker/track.html?order=${currentOrderNumber}`;
                    trackLink.innerHTML = `
                        <i class="fas fa-link"></i> 
                        <a href="${trackUrl}" target="_blank">–û—Ç—Å–ª–µ–¥–∏—Ç—å –∑–∞–∫–∞–∑</a>
                    `;
                    
                    // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º QR-–∫–æ–¥
                    qrCode.innerHTML = '';
                    QRCode.toCanvas(trackUrl, { width: 200 }, (err, canvas) => {
                        if (err) {
                            console.error(err);
                            return;
                        }
                        qrCode.appendChild(canvas);
                    });
                    
                    // –ù–∞—á–∏–Ω–∞–µ–º —Å–ª—É—à–∞—Ç—å —Å—Ç–∞—Ç—É—Å
                    listenToOrderStatus(currentOrderNumber);
                    
                    // –û—á–∏—â–∞–µ–º –∫–æ—Ä–∑–∏–Ω—É
                    cart = [];
                    updateCartDisplay();
                    
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞:', error);
                    toast.textContent = '‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–∏';
                    toast.classList.add('show');
                    setTimeout(() => toast.classList.remove('show'), 2000);
                }
            });

            // ========== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ==========
            renderProducts();
            updateCartDisplay();
        })();
    </script>
</body>
</html>
